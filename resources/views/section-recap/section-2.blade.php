<h3 class="mt-3 text-center">Section 2 (Identifikasi tujuan risiko teknologi
    informasi organisasi)</h3>

<!-- Deskripsi -->
<p class="mt-3">
    Kuisioner ini bertujuan untuk mengidentifikasi tujuan teknologi informasi
    (TI) yang diterapkan dalam organisasi. Kuisioner ini berfokus pada penilaian
    tingkat kepentingan berbagai tujuan TI yang dianggap relevan dengan kondisi
    organisasi saat ini.<br>
    Untuk setiap pernyataan yang diberikan, harap pilih angka pada skala 1
    hingga 5 untuk menunjukkan tingkat kepentingannya menurut pandangan Anda.
</p>
<p>
    <strong>Skala kepentingan:</strong><br>
    1 = Sangat tidak penting<br>
    2 = Tidak penting<br>
    3 = Penting<br>
    4 = Cukup penting<br>
    5 = Sangat penting
</p>

<div class="text-end mb-3">
    <small id="lastUpdated-section-2" class="text-muted"></small>
</div>

<!-- Tabel -->
<div class="table-responsive mt-4">
    <table class="table table-bordered">
        <thead class="thead-light">
            <tr>
                <th>Acuan</th>
                <th>Tujuan Perusahaan</th>
                <th>Tingkat Kepentingan (1-5)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>EG01</td>
                <td>Seberapa penting memastikan portofolio produk dan layanan tetap kompetitif di pasar?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG01"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG02</td>
                <td>Seberapa Penting pengelolaan risiko bisnis untuk memastikan stabilitas operasional?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG02"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG03</td>
                <td>Seberapa penting kepatuhan terhadap hukum dan regulasi untuk menghindari dapak negatif?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG03"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG04</td>
                <td>Seberapa penting kualitas informasi keuangan untuk pengambilan keputusan strategis?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG04"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG05</td>
                <td>Seberapa penting membangun budaya layanan yang fokus pada kebutuhan pelanggan?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG05"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG06</td>
                <td>Seberapa penting memastikan layanan bisnis tersedia tanpa gangguan?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG06"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG07</td>
                <td>Seberapa penting kualitas informasi manajemen dalam mendukung keputusan bisnis?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG07"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG08</td>
                <td>Seberapa penting optimalisasi proses bisnis internal untuk mendukung efisiensi operasional?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG08"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG09</td>
                <td>Seberapa penting optimalisasi biaya proses bisnis untuk mendukung efisiensi anggaran?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG09"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG10</td>
                <td>Seberapa penting keterampilan dan motivasi staff untuk meningkatkan produktivitas?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG10"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG11</td>
                <td>Seberapa penting kepatuhan terhadap kebijakan internal dalam mendukung pertumbuhan organisasi?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG11"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG12</td>
                <td>Seberapa penting program transformasi digital untuk mendukung pertumbuhan organisasi?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG12"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>EG13</td>
                <td>Seberapa penting inovasi produk dan bisnis dalam mendukung pencapaian tujuan jangka
                    panjang organisasi?</td>
                <td>
                    <div style="width: 120px; height: 120px; margin: auto;">
                        <canvas id="EG13"></canvas>
                    </div>
                    <div class="mt-2 text-center">
                        <span class="badge" style="background-color: #FF6384;">1</span>
                        <span class="badge" style="background-color: #36A2EB;">2</span>
                        <span class="badge" style="background-color: #FFCE56;">3</span>
                        <span class="badge" style="background-color: #4BC0C0;">4</span>
                        <span class="badge" style="background-color: #9966FF;">5</span>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

@push('scripts')
    <script>
        // Chart instances
        let eg01, eg02, eg03, eg04 ,eg05, eg06, eg07, eg08, eg09, eg10, eg11, eg12, eg13;

        // Fungsi untuk inisialisasi chart
        function createChart(canvasId, data) {
            const ctx = document.getElementById(canvasId).getContext("2d");
            return new Chart(ctx, {
                type: "pie",
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false,
                        },
                    },
                },
            });
        }

        // Fetch and update data
        async function fetchData_section_2(formId) {
            try {
                const response = await fetch(`/data-section-2/${formId}`);
                const data = await response.json();

                if (data) {
                    eg01.data.datasets[0].data = [
                        data.pertanyaan_1_jawaban_1,
                        data.pertanyaan_1_jawaban_2,
                        data.pertanyaan_1_jawaban_3,
                        data.pertanyaan_1_jawaban_4,
                        data.pertanyaan_1_jawaban_5
                    ];
                    eg01.update();

                    eg02.data.datasets[0].data = [
                        data.pertanyaan_2_jawaban_1,
                        data.pertanyaan_2_jawaban_2,
                        data.pertanyaan_2_jawaban_3,
                        data.pertanyaan_2_jawaban_4,
                        data.pertanyaan_2_jawaban_5
                    ];
                    eg02.update();

                    eg03.data.datasets[0].data = [
                        data.pertanyaan_3_jawaban_1,
                        data.pertanyaan_3_jawaban_2,
                        data.pertanyaan_3_jawaban_3,
                        data.pertanyaan_3_jawaban_4,
                        data.pertanyaan_3_jawaban_5
                    ];
                    eg03.update();

                    eg04.data.datasets[0].data = [
                        data.pertanyaan_4_jawaban_1,
                        data.pertanyaan_4_jawaban_2,
                        data.pertanyaan_4_jawaban_3,
                        data.pertanyaan_4_jawaban_4,
                        data.pertanyaan_4_jawaban_5
                    ];
                    eg04.update();

                    eg05.data.datasets[0].data = [
                        data.pertanyaan_5_jawaban_1,
                        data.pertanyaan_5_jawaban_2,
                        data.pertanyaan_5_jawaban_3,
                        data.pertanyaan_5_jawaban_4,
                        data.pertanyaan_5_jawaban_5
                    ];
                    eg05.update();

                    eg06.data.datasets[0].data = [
                        data.pertanyaan_6_jawaban_1,
                        data.pertanyaan_6_jawaban_2,
                        data.pertanyaan_6_jawaban_3,
                        data.pertanyaan_6_jawaban_4,
                        data.pertanyaan_6_jawaban_5
                    ];
                    eg06.update();

                    eg07.data.datasets[0].data = [
                        data.pertanyaan_7_jawaban_1,
                        data.pertanyaan_7_jawaban_2,
                        data.pertanyaan_7_jawaban_3,
                        data.pertanyaan_7_jawaban_4,
                        data.pertanyaan_7_jawaban_5
                    ];
                    eg07.update();

                    eg08.data.datasets[0].data = [
                        data.pertanyaan_8_jawaban_1,
                        data.pertanyaan_8_jawaban_2,
                        data.pertanyaan_8_jawaban_3,
                        data.pertanyaan_8_jawaban_4,
                        data.pertanyaan_8_jawaban_5
                    ];
                    eg08.update();

                    eg09.data.datasets[0].data = [
                        data.pertanyaan_9_jawaban_1,
                        data.pertanyaan_9_jawaban_2,
                        data.pertanyaan_9_jawaban_3,
                        data.pertanyaan_9_jawaban_4,
                        data.pertanyaan_9_jawaban_5
                    ];
                    eg09.update();

                    eg10.data.datasets[0].data = [
                        data.pertanyaan_10_jawaban_1,
                        data.pertanyaan_10_jawaban_2,
                        data.pertanyaan_10_jawaban_3,
                        data.pertanyaan_10_jawaban_4,
                        data.pertanyaan_10_jawaban_5
                    ];
                    eg10.update();

                    eg11.data.datasets[0].data = [
                        data.pertanyaan_11_jawaban_1,
                        data.pertanyaan_11_jawaban_2,
                        data.pertanyaan_11_jawaban_3,
                        data.pertanyaan_11_jawaban_4,
                        data.pertanyaan_11_jawaban_5
                    ];
                    eg11.update();

                    eg12.data.datasets[0].data = [
                        data.pertanyaan_12_jawaban_1,
                        data.pertanyaan_12_jawaban_2,
                        data.pertanyaan_12_jawaban_3,
                        data.pertanyaan_12_jawaban_4,
                        data.pertanyaan_12_jawaban_5
                    ];
                    eg12.update();

                    eg13.data.datasets[0].data = [
                        data.pertanyaan_13_jawaban_1,
                        data.pertanyaan_13_jawaban_2,
                        data.pertanyaan_13_jawaban_3,
                        data.pertanyaan_13_jawaban_4,
                        data.pertanyaan_13_jawaban_5
                    ];
                    eg13.update();

                    // Update last updated timestamp if needed
                    if (data) {
                        const totalResponses = data.total_responses ?? 0;
                        const totalAuditee = data.total_auditee ?? 0;
                        const lastUpdated = data.last_updated_at ?
                            `Terakhir diperbarui: ${new Date(data.last_updated_at).toLocaleString('id-ID')}` :
                            'Belum ada data';

                        document.getElementById('lastUpdated-section-2').textContent =
                            `Total Responden: ${totalResponses} Orang dari ${totalAuditee} Auditee, ${lastUpdated}`;
                    } else {
                        document.getElementById('lastUpdated-section-2').textContent =
                            'Belum ada data tersedia';
                    }
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {
            // Create charts
            eg01 = createChart("EG01", {
                ...dataTemplate
            });
            eg02 = createChart("EG02", {
                ...dataTemplate
            });
            eg03 = createChart("EG03", {
                ...dataTemplate
            });
            eg04 = createChart("EG04", {
                ...dataTemplate
            });
            eg05 = createChart("EG05", {
                ...dataTemplate
            });
            eg06 = createChart("EG06", {
                ...dataTemplate
            });
            eg07 = createChart("EG07", {
                ...dataTemplate
            });
            eg08 = createChart("EG08", {
                ...dataTemplate
            });
            eg09 = createChart("EG09", {
                ...dataTemplate
            });
            eg10 = createChart("EG10", {
                ...dataTemplate
            });
            eg11 = createChart("EG11", {
                ...dataTemplate
            });
            eg12 = createChart("EG12", {
                ...dataTemplate
            });
            eg13 = createChart("EG13", {
                ...dataTemplate
            });

            // Fetch initial data (replace 1 with your actual form_id)
            fetchData_section_2('{{ $form->id }}');
        });
    </script>
@endpush
